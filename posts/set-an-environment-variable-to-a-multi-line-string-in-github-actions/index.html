<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://howto.pandey.me/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>Set an Environment Variable to a Multi-line String in GitHub Actions</title>
<script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","d6qfzorlb9")</script></head><body><header id=banner><h2><a href=https://howto.pandey.me/>How To...</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/tags title=tags>tags</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Set an Environment Variable to a Multi-line String in GitHub Actions</h1><div><time>May 7, 2024</time></div></header><p>When creating GitHub Actions workflows, it&rsquo;s often useful to set environment variables to pass info from one step to the next.</p><p>Setting an environment variable to a single-line string is easy. Assuming <code>my-cmd</code> is any command that produces a single-line output, you can set the variable like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set environment variable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;MY_ENV_VAR=$(my-cmd)&#34; &gt;&gt; &#34;$GITHUB_ENV&#34;</span><span class=w>
</span></span></span></code></pre></div><p>And use <code>$MY_ENV_VAR</code> or <code>${{ env.MY_ENV_VAR }}</code> in subsequent steps.</p><p>But this doesn&rsquo;t work for multi-line strings. If you try to do that, you will see an error like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>Error: Unable to process file <span class=nb>command</span> <span class=s1>&#39;env&#39;</span> successfully.
</span></span><span class=line><span class=cl>Error: Invalid format ...
</span></span></code></pre></div><p>To correctly set an environment variable to a multi-line string, you have to use a different syntax. Assuming <code>my-cmd</code> is any command that produces a multi-line output, you can set the variable like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set environment variable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      {
</span></span></span><span class=line><span class=cl><span class=sd>        echo &#34;CHANGELOG&lt;&lt;EOF&#34;
</span></span></span><span class=line><span class=cl><span class=sd>        echo &#34;$(my-cmd)&#34;
</span></span></span><span class=line><span class=cl><span class=sd>        echo EOF
</span></span></span><span class=line><span class=cl><span class=sd>      } &gt;&gt; &#34;$GITHUB_ENV&#34;</span><span class=w>      
</span></span></span></code></pre></div><p>After this, you can once again use <code>$MY_ENV_VAR</code> or <code>${{ env.MY_ENV_VAR }}</code> in subsequent steps.</p><p><a href=https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions#multiline-strings>source</a></p></article></main><footer id=footer>Â© 2024 Sunil Pandey</footer></body></html>