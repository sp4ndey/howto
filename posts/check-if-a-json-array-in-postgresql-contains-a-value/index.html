<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://howto.pandey.me/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>Check if a JSON array in PostgreSQL contains a value</title>
<script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","d6qfzorlb9")</script></head><body><header id=banner><h2><a href=https://howto.pandey.me/>How To...</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/tags title=tags>tags</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Check if a JSON array in PostgreSQL contains a value</h1><div><time>January 29, 2025</time></div></header><p>Say you have a table named <code>books</code>, with a JSON column, <code>metadata</code>, and within this column, there is an array named <code>tags</code>.</p><p>The data in this table might look like this:</p><table><thead><tr><th>title</th><th>metadata</th></tr></thead><tbody><tr><td>Ready Player One</td><td>{&ldquo;tags&rdquo;: [&ldquo;sci-fi&rdquo;, &ldquo;gaming&rdquo;]}</td></tr><tr><td>Snow Crash</td><td>{&ldquo;tags&rdquo;: [&ldquo;sci-fi&rdquo;, &ldquo;cyberpunk&rdquo;]}</td></tr><tr><td>In Real Life</td><td>{&ldquo;tags&rdquo;: [&ldquo;graphic novel&rdquo;, &ldquo;gaming&rdquo;]}</td></tr></tbody></table><p>Now, say you want to find out all the books that have the tag <code>gaming</code>. You can extract the <code>tags</code> field using the <code>-></code> operator, and check whether or not it contains <code>gaming</code> using the <code>?</code> operator.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>metadata</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>books</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>metadata</span><span class=o>-&gt;</span><span class=s1>&#39;tags&#39;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s1>&#39;gaming&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>which will return:</p><table><thead><tr><th>title</th><th>metadata</th></tr></thead><tbody><tr><td>Ready Player One</td><td>{&ldquo;tags&rdquo;: [&ldquo;sci-fi&rdquo;, &ldquo;gaming&rdquo;]}</td></tr><tr><td>In Real Life</td><td>{&ldquo;tags&rdquo;: [&ldquo;graphic novel&rdquo;, &ldquo;gaming&rdquo;]}</td></tr></tbody></table><p><a href=https://www.postgresql.org/docs/current/functions-json.html>source</a></p></article></main><footer id=footer>Â© 2024 Sunil Pandey</footer></body></html>